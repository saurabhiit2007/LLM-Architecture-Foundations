
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The theoretical building blocks. "How is the model built?"">
      
      
        <meta name="author" content="Saurabh Goyal">
      
      
      
        <link rel="prev" href="../claude/">
      
      
        <link rel="next" href="../gemini/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Llama - LLM-Architecture_Foundations</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-model-breakdown" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="LLM-Architecture_Foundations" class="md-header__button md-logo" aria-label="LLM-Architecture_Foundations" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LLM-Architecture_Foundations
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Llama
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-purple"  aria-hidden="true"  type="radio" name="__palette" id="__palette_0">
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="lime"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/saurabhiit2007/LLM-Architecture-Foundations" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="LLM-Architecture_Foundations" class="md-nav__button md-logo" aria-label="LLM-Architecture_Foundations" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    LLM-Architecture_Foundations
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/saurabhiit2007/LLM-Architecture-Foundations" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Model Architecture Families
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Model Architecture Families
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model_architecture_families/encoder_decoder_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Encoder Decoder Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model_architecture_families/dense_vs_sparse_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dense vs Sparse Models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../model_architecture_families/mixture_of_experts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mixture of Models (MoE)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Attention Mechanisms
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Attention Mechanisms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_mechanisms/mha/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Head Attention
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_mechanisms/mqa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi Query Attention (MQA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_mechanisms/gqa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Grouped Query Attention (GQA)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../attention_mechanisms/sliding_window/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sliding Window
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Real World Model Families
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Real World Model Families
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../claude/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Claude
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Llama
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Llama
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-model-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      1. Model Breakdown
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-training-strategy-the-meta-recipe" class="md-nav__link">
    <span class="md-ellipsis">
      2. Training Strategy: The "Meta Recipe"
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Training Strategy: The &#34;Meta Recipe&#34;">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-over-training-on-massive-data" class="md-nav__link">
    <span class="md-ellipsis">
      A. Over-training on Massive Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-teacher-student-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      B. Teacher-Student Distillation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-iterative-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      C. Iterative Alignment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-system-1-vs-system-2-reasoning" class="md-nav__link">
    <span class="md-ellipsis">
      3. System 1 vs. System 2 Reasoning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. System 1 vs. System 2 Reasoning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-1-fast-intuitive" class="md-nav__link">
    <span class="md-ellipsis">
      System 1 (Fast &amp; Intuitive)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-2-slow-deliberate" class="md-nav__link">
    <span class="md-ellipsis">
      System 2 (Slow &amp; Deliberate)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-engineering-deep-dive-llama-specifics" class="md-nav__link">
    <span class="md-ellipsis">
      4. Engineering Deep-Dive: Llama Specifics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Engineering Deep-Dive: Llama Specifics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-grouped-query-attention-gqa" class="md-nav__link">
    <span class="md-ellipsis">
      A. Grouped-Query Attention (GQA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-the-128k-tokenizer-efficiency" class="md-nav__link">
    <span class="md-ellipsis">
      B. The 128K Tokenizer Efficiency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-scaling-the-post-training-stack" class="md-nav__link">
    <span class="md-ellipsis">
      C. Scaling the "Post-Training" Stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-rope-rotary-positional-embeddings-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      D. RoPE (Rotary Positional Embeddings) Scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-tool-use-environment-impact" class="md-nav__link">
    <span class="md-ellipsis">
      E. Tool Use &amp; Environment Impact
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gemini/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gemini
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openai/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenAI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mistral/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mistral
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dense_vs_MoE_comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dense vs MoE Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../general_comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    General Comparison
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Transformer Components
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Transformer Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tokenization
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Tokenization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenization/unigram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unigram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenization/sentence_piece_unigram/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sentence Piece Unigram
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenization/byte_pair_encoding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Byte Pair Encoding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenization/tiktoken/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TikToken
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tokenization/vocabulary_size_tradeoffs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vocabulary Size Tradeoffs
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Positional Encodings
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Positional Encodings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../positional_encodings/RoPE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RoPE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../positional_encodings/ALiBi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ALiBi
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Pretraining objective
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Pretraining objective
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Scaling laws
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Scaling laws
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../references.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-model-breakdown" class="md-nav__link">
    <span class="md-ellipsis">
      1. Model Breakdown
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-training-strategy-the-meta-recipe" class="md-nav__link">
    <span class="md-ellipsis">
      2. Training Strategy: The "Meta Recipe"
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Training Strategy: The &#34;Meta Recipe&#34;">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-over-training-on-massive-data" class="md-nav__link">
    <span class="md-ellipsis">
      A. Over-training on Massive Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-teacher-student-distillation" class="md-nav__link">
    <span class="md-ellipsis">
      B. Teacher-Student Distillation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-iterative-alignment" class="md-nav__link">
    <span class="md-ellipsis">
      C. Iterative Alignment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-system-1-vs-system-2-reasoning" class="md-nav__link">
    <span class="md-ellipsis">
      3. System 1 vs. System 2 Reasoning
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. System 1 vs. System 2 Reasoning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#system-1-fast-intuitive" class="md-nav__link">
    <span class="md-ellipsis">
      System 1 (Fast &amp; Intuitive)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#system-2-slow-deliberate" class="md-nav__link">
    <span class="md-ellipsis">
      System 2 (Slow &amp; Deliberate)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-engineering-deep-dive-llama-specifics" class="md-nav__link">
    <span class="md-ellipsis">
      4. Engineering Deep-Dive: Llama Specifics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Engineering Deep-Dive: Llama Specifics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-grouped-query-attention-gqa" class="md-nav__link">
    <span class="md-ellipsis">
      A. Grouped-Query Attention (GQA)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-the-128k-tokenizer-efficiency" class="md-nav__link">
    <span class="md-ellipsis">
      B. The 128K Tokenizer Efficiency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-scaling-the-post-training-stack" class="md-nav__link">
    <span class="md-ellipsis">
      C. Scaling the "Post-Training" Stack
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-rope-rotary-positional-embeddings-scaling" class="md-nav__link">
    <span class="md-ellipsis">
      D. RoPE (Rotary Positional Embeddings) Scaling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#e-tool-use-environment-impact" class="md-nav__link">
    <span class="md-ellipsis">
      E. Tool Use &amp; Environment Impact
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>Llama</h1>

<h2 id="1-model-breakdown">1. Model Breakdown<a class="headerlink" href="#1-model-breakdown" title="Permanent link">&para;</a></h2>
<p>The Llama family has evolved from simple text prediction into a multi-tiered ecosystem of specialized models.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Generation</th>
<th style="text-align: left;">Key Models</th>
<th style="text-align: left;">Primary Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Llama 3.1</strong></td>
<td style="text-align: left;">8B, 70B, 405B</td>
<td style="text-align: left;"><strong>Frontier Intelligence:</strong> The 405B model was the first open-weights model to compete with GPT-4o.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Llama 3.2</strong></td>
<td style="text-align: left;">1B, 3B, 11B, 90B</td>
<td style="text-align: left;"><strong>Vision &amp; Edge:</strong> Introduced native multimodal capabilities and ultra-small versions for mobile devices.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Llama 3.3</strong></td>
<td style="text-align: left;">70B</td>
<td style="text-align: left;"><strong>Efficiency King:</strong> Refines the 70B architecture to match 405B performance levels at a fraction of the cost.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Llama 4</strong></td>
<td style="text-align: left;">Scout, Maverick</td>
<td style="text-align: left;"><strong>Agentic AI:</strong> Focuses on native video/audio processing and advanced autonomous reasoning.</td>
</tr>
</tbody>
</table>
<hr />
<hr />
<h2 id="2-training-strategy-the-meta-recipe">2. Training Strategy: The "Meta Recipe"<a class="headerlink" href="#2-training-strategy-the-meta-recipe" title="Permanent link">&para;</a></h2>
<p>Meta's strategy focuses on "squeezing" maximum intelligence into smaller parameter counts through three primary methods:</p>
<h3 id="a-over-training-on-massive-data">A. Over-training on Massive Data<a class="headerlink" href="#a-over-training-on-massive-data" title="Permanent link">&para;</a></h3>
<p>While standard models are trained until they are "optimal" (per Chinchilla scaling laws), Meta trains Llama models on <strong>15+ trillion tokens</strong>. This ensures that even the small 8B models have high "world knowledge" and linguistic nuance.</p>
<h3 id="b-teacher-student-distillation">B. Teacher-Student Distillation<a class="headerlink" href="#b-teacher-student-distillation" title="Permanent link">&para;</a></h3>
<p>For Llama 3.2 and 3.3, Meta used their largest model (405B) to generate high-quality synthetic data. The smaller models were then trained on these "perfect" reasoning traces, effectively inheriting the logic of the larger model without the massive hardware requirements.</p>
<h3 id="c-iterative-alignment">C. Iterative Alignment<a class="headerlink" href="#c-iterative-alignment" title="Permanent link">&para;</a></h3>
<p>Meta uses a combination of:
* <strong>Rejection Sampling:</strong> Generating multiple outputs and selecting only the highest quality for the next training round.
* <strong>Direct Preference Optimization (DPO):</strong> Aligning the model to prefer specific styles of reasoning over others based on human feedback.</p>
<hr />
<hr />
<h2 id="3-system-1-vs-system-2-reasoning">3. System 1 vs. System 2 Reasoning<a class="headerlink" href="#3-system-1-vs-system-2-reasoning" title="Permanent link">&para;</a></h2>
<h3 id="system-1-fast-intuitive">System 1 (Fast &amp; Intuitive)<a class="headerlink" href="#system-1-fast-intuitive" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Models:</strong> Llama 3.1 (8B/70B), Llama 3.2.</li>
<li><strong>Behavior:</strong> These are "next-token predictors." They provide instant, fluid answers based on pattern recognition. </li>
<li><strong>Limitation:</strong> They can suffer from "hallucinations" in complex logic because they don't pause to verify their own steps.</li>
</ul>
<h3 id="system-2-slow-deliberate">System 2 (Slow &amp; Deliberate)<a class="headerlink" href="#system-2-slow-deliberate" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Models:</strong> Llama 4 (Maverick), Llama 3.1 (405B).</li>
<li><strong>Behavior:</strong> These models incorporate <strong>Chain-of-Thought (CoT)</strong> and "test-time scaling." </li>
<li><strong>Difference:</strong> Instead of guessing the next word, they can "think" through a problem. Llama 4, in particular, is designed to perform agentic loopsâ€”checking its own work and iterating on a solution before outputting the final result.</li>
</ul>
<hr />
<hr />
<h2 id="4-engineering-deep-dive-llama-specifics">4. Engineering Deep-Dive: Llama Specifics<a class="headerlink" href="#4-engineering-deep-dive-llama-specifics" title="Permanent link">&para;</a></h2>
<p>If you are asked "What makes the Llama 3/4 lineage unique compared to GPT or Claude?", focus on these four pillars:</p>
<h3 id="a-grouped-query-attention-gqa">A. Grouped-Query Attention (GQA)<a class="headerlink" href="#a-grouped-query-attention-gqa" title="Permanent link">&para;</a></h3>
<p>Unlike Llama 2 (where only the large models had GQA), <strong>every model in the Llama 3/4 family</strong> uses GQA.
* <strong>Impact:</strong> Explain that GQA reduces the memory footprint of the KV (Key-Value) cache. This allows for higher throughput and larger context windows (like the 128k jump in Llama 3.1) without requiring linear increases in VRAM. It is the reason these models are so performant on consumer-grade GPUs.</p>
<h3 id="b-the-128k-tokenizer-efficiency">B. The 128K Tokenizer Efficiency<a class="headerlink" href="#b-the-128k-tokenizer-efficiency" title="Permanent link">&para;</a></h3>
<p>Llama 3/4 uses a <strong>Tiktoken-based tokenizer</strong> with a 128k vocabulary (up from 32k).
* <strong>The "So What?":</strong> A larger vocabulary means the model represents more text with fewer tokens. This improves inference speed and performance on non-English languages and code, as the model doesn't have to "break down" common words into as many tiny sub-fragments.</p>
<h3 id="c-scaling-the-post-training-stack">C. Scaling the "Post-Training" Stack<a class="headerlink" href="#c-scaling-the-post-training-stack" title="Permanent link">&para;</a></h3>
<p>Meta has moved the "magic" from the Pre-training phase to the <strong>Post-training phase</strong>.
* <strong>Key Terms:</strong> Mention <strong>PPO (Proximal Policy Optimization)</strong> vs. <strong>DPO (Direct Preference Optimization)</strong>. 
* <strong>The Nuance:</strong> Meta uses Llama 3.1 405B to generate "Preference Data" for the smaller models. If asked about "System 2," explain that this involves <strong>Rejection Sampling</strong>, where the model explores multiple "reasoning traces" and is only rewarded for the one that leads to the correct answer.</p>
<h3 id="d-rope-rotary-positional-embeddings-scaling">D. RoPE (Rotary Positional Embeddings) Scaling<a class="headerlink" href="#d-rope-rotary-positional-embeddings-scaling" title="Permanent link">&para;</a></h3>
<p>To achieve the 128k context window in Llama 3.1, Meta had to modify the <strong>RoPE base frequency</strong>.
* <strong>Technical Detail:</strong> They increased the base frequency (theta) to <strong>500,000</strong>. 
* <strong>Insight:</strong> If asked how they handled long-range dependencies, mention that this scaling allows the model to "attend" to tokens that are much further apart in the sequence without losing the relative positional logic.</p>
<h3 id="e-tool-use-environment-impact">E. Tool Use &amp; Environment Impact<a class="headerlink" href="#e-tool-use-environment-impact" title="Permanent link">&para;</a></h3>
<p>Llama 3.1 was the first to be "natively" trained for tool use (Search, Wolfram Alpha, Code Interpreter).
* <strong>System 1 vs. 2 Link:</strong> Standard models "hallucinate" tool arguments (System 1). Llama 4 uses <strong>Agentic Loops</strong> (System 2) to "call a tool -&gt; observe the error -&gt; try again," which is a fundamental shift in how the model handles external APIs.</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.expand", "navigation.top", "search.highlight", "search.share", "content.code.copy", "mathjax"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>